<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Microphysics_1M Â· ClimateMachine</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-191640394-1', 'auto');
ga('send', 'pageview', {'page': location.pathname + location.search + location.hash});
</script><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../GettingStarted/Installation/">Installation</a></li><li><a class="tocitem" href="../../../GettingStarted/Terminology/">Terminology</a></li><li><a class="tocitem" href="../../../GettingStarted/RunningClimateMachine/">Running</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Defaults</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../GettingStarted/Atmos/">Atmosphere model configurations</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/TutorialList/">Home</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">BalanceLaws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/BalanceLaws/tendency_specification_layer/">Tendency specification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Atmos/heldsuarez/">Dry Idealized GCM (Held-Suarez)</a></li><li><a class="tocitem" href="../../../generated/Atmos/burgers_single_stack/">Single Element Stack Experiment (Burgers Equation)</a></li><li><a class="tocitem" href="../../../generated/Atmos/burgers_single_stack_fvm/">Finite Volume Single Element Stack Experiment (Burgers Equation)</a></li><li><a class="tocitem" href="../../../generated/Atmos/burgers_single_stack_bjfnk/">HEVI Single Element Stack Experiment (Burgers Equation)</a></li><li><a class="tocitem" href="../../../generated/Atmos/densitycurrent/">LES Experiment (Density Current)</a></li><li><a class="tocitem" href="../../../generated/Atmos/risingbubble/">LES Experiment (Rising Thermal Bubble)</a></li><li><a class="tocitem" href="../../../generated/Atmos/agnesi_hs_lin/">Linear Hydrostatic Mountain (Topography)</a></li><li><a class="tocitem" href="../../../generated/Atmos/agnesi_nh_lin/">Linear Non-Hydrostatic Mountain (Topography)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-4-1" type="checkbox"/><label class="tocitem" for="menuitem-3-4-1"><span class="docs-label">Heat</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Land/Heat/heat_equation/">Heat Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4-2" type="checkbox"/><label class="tocitem" for="menuitem-3-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Land/Soil/Water/hydraulic_functions/">Hydraulic Functions</a></li><li><a class="tocitem" href="../../../generated/Land/Soil/Heat/bonan_heat_tutorial/">Soil Heat Equation</a></li><li><a class="tocitem" href="../../../generated/Land/Soil/Water/equilibrium_test/">Richards Equation</a></li><li><a class="tocitem" href="../../../generated/Land/Soil/Coupled/equilibrium_test/">Coupled Water and Heat</a></li><li><a class="tocitem" href="../../../generated/Land/Soil/PhaseChange/freezing_front/">Phase Change I</a></li><li><a class="tocitem" href="../../../generated/Land/Soil/PhaseChange/phase_change_analytic_test/">Phase Change II</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Ocean</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Ocean/geostrophic_adjustment/">One-dimensional geostrophic adjustment</a></li><li><a class="tocitem" href="../../../generated/Ocean/internal_wave/">Propagating mode-1 internal wave</a></li><li><a class="tocitem" href="../../../generated/Ocean/shear_instability/">Shear instability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-6-1" type="checkbox"/><label class="tocitem" for="menuitem-3-6-1"><span class="docs-label">System Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/SystemSolvers/cg/">Conjugate Gradient</a></li><li><a class="tocitem" href="../../../generated/Numerics/SystemSolvers/bgmres/">Batched Generalized Minimal Residual</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-2"><span class="docs-label">DG Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/DGMethods/showcase_filters/">Filters</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3"><span class="docs-label">Time-Stepping</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/ts_intro/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-6-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-2"><span class="docs-label">Explicit Runge-Kutta methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/explicit_lsrk/">Single-rate Explicit Timestepping</a></li><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/tutorial_risingbubble_config/">Rising Thermal Bubble Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-3"><span class="docs-label">Implicit-Explicit (IMEX) Additive Runge-Kutta methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/imex_ark/">Implicit-Explicit (IMEX) Additively-Partitioned Runge-Kutta Timestepping</a></li><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/tutorial_acousticwave_config/">Acoustic Wave Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-4"><span class="docs-label">Multirate Runge-Kutta methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/multirate_rk/">Multirate Runge-Kutta Timestepping</a></li><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/tutorial_risingbubble_config/">Rising Thermal Bubble Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-5"><span class="docs-label">MIS methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/mis/">Multirate Infinitesimal Step (MIS) Timestepping</a></li><li><a class="tocitem" href="../../../generated/Numerics/TimeStepping/tutorial_acousticwave_config/">Acoustic Wave Configuration</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-7-1" type="checkbox"/><label class="tocitem" for="menuitem-3-7-1"><span class="docs-label">Debug</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated/Diagnostics/Debug/StateCheck/">State Statistics Regression</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../HowToGuides/Common/UniversalFunctions/">Universal Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Balance Laws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../HowToGuides/BalanceLaws/how_to_make_a_balance_law/">How to make a balance law</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../HowToGuides/Atmos/AtmosReferenceState/">Reference profiles</a></li><li><a class="tocitem" href="../../../HowToGuides/Atmos/MoistureModelChoices/">Moisture model</a></li><li><a class="tocitem" href="../../../HowToGuides/Atmos/PrecipitationModelChoices/">Precipitation model</a></li><li><a class="tocitem" href="../../../HowToGuides/Atmos/MoistureAndPrecip/">How to create an experiment with moisture and precipitation</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-4-6-2" type="checkbox"/><label class="tocitem" for="menuitem-4-6-2"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../HowToGuides/Numerics/ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6-3" type="checkbox"/><label class="tocitem" for="menuitem-4-6-3"><span class="docs-label">System Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../HowToGuides/Numerics/SystemSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-7" type="checkbox"/><label class="tocitem" for="menuitem-4-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../HowToGuides/Diagnostics/UsingDiagnostics/">Using Diagnostics</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/">Home</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Driver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Driver/">Top level interface</a></li><li><a class="tocitem" href="../../../APIs/Driver/Checkpoint/">Checkpoint</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Atmos/AtmosModel/">AtmosModel</a></li></ul></li><li><a class="tocitem" href="../../../APIs/Ocean/Ocean/">Ocean</a></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Land/LandModel/">Land Model</a></li><li><a class="tocitem" href="../../../APIs/Land/Runoff/">Runoff Parameterizations</a></li><li><a class="tocitem" href="../../../APIs/Land/SoilWaterParameterizations/">Soil Water Parameterizations</a></li><li><a class="tocitem" href="../../../APIs/Land/SoilHeatParameterizations/">Soil Heat Parameterizations</a></li><li><a class="tocitem" href="../../../APIs/Land/SurfaceFlow/">Surface Flow</a></li><li><a class="tocitem" href="../../../APIs/Land/RadiativeEnergyFlux/">Radiative Boundary Conditions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Common/Orientations/">Orientations</a></li><li><a class="tocitem" href="../../../APIs/Common/CartesianDomains/">Cartesian Domains</a></li><li><a class="tocitem" href="../../../APIs/Common/CartesianFields/">Cartesian Fields</a></li><li><a class="tocitem" href="../../../APIs/Common/Spectra/">Spectra</a></li><li><a class="tocitem" href="../../../APIs/Common/SurfaceFluxes/">Surface Fluxes</a></li><li><a class="tocitem" href="../../../APIs/Common/TurbulenceClosures/">Turbulence Closures</a></li><li><a class="tocitem" href="../../../APIs/Common/TurbulenceConvection/">Turbulence Convection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Balance Laws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/BalanceLaws/BalanceLaws/">Balance Laws</a></li><li><a class="tocitem" href="../../../APIs/BalanceLaws/Problems/">Problems</a></li></ul></li><li><a class="tocitem" href="../../../APIs/Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-5-9" type="checkbox"/><label class="tocitem" for="menuitem-5-9"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Diagnostics/Diagnostics/">Diagnostics groups</a></li><li><a class="tocitem" href="../../../APIs/Diagnostics/DiagnosticsMachine/">DiagnosticsMachine</a></li><li><a class="tocitem" href="../../../APIs/Diagnostics/StdDiagnostics/">StdDiagnostics</a></li><li><a class="tocitem" href="../../../APIs/Diagnostics/StateCheck/">State Check</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-10" type="checkbox"/><label class="tocitem" for="menuitem-5-10"><span class="docs-label">Input/Output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-11" type="checkbox"/><label class="tocitem" for="menuitem-5-11"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Numerics/Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../../APIs/Numerics/SystemSolvers/SystemSolvers/">SystemSolvers</a></li><li><a class="tocitem" href="../../../APIs/Numerics/ODESolvers/ODESolvers/">ODESolvers</a></li><li><a class="tocitem" href="../../../APIs/Numerics/DGMethods/DGMethods/">DG Methods</a></li><li><a class="tocitem" href="../../../APIs/Numerics/DGMethods/Courant/">Courant</a></li><li><a class="tocitem" href="../../../APIs/Numerics/DGMethods/NumericalFluxes/">Numerical Fluxes</a></li><li><a class="tocitem" href="../../../APIs/Numerics/DGMethods/FVReconstructions/">Finite Volume Reconstructions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-12" type="checkbox"/><label class="tocitem" for="menuitem-5-12"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../APIs/Utilities/VariableTemplates/">Variable Templates</a></li><li><a class="tocitem" href="../../../APIs/Utilities/SingleStackUtils/">Single Stack Utilities</a></li><li><a class="tocitem" href="../../../APIs/Utilities/TicToc/">Tic Toc</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../Contributing/">Contribution guide</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Common/SurfaceFluxes/">SurfaceFluxes</a></li><li><a class="tocitem" href="../../Common/Turbulence/">Turbulence Closures</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox" checked/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../EDMF_plots/">EDMF Model</a></li><li><a class="tocitem" href="../Microphysics_0M/">Microphysics_0M</a></li><li class="is-active"><a class="tocitem" href>Microphysics_1M</a><ul class="internal"><li><a class="tocitem" href="#Coupling-to-the-state-variables"><span>Coupling to the state variables</span></a></li></ul></li><li><a class="tocitem" href="../EDMFEquations/">EDMF equations</a></li><li><a class="tocitem" href="../Model/tracers/">Tracers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../DevDocs/CodeStyle/">Coding style</a></li><li><a class="tocitem" href="../../../DevDocs/AcceptableUnicode/">Acceptable Unicode</a></li><li><a class="tocitem" href="../../../DevDocs/ModelVariableList/">Model variable list</a></li><li><a class="tocitem" href="../../../DevDocs/ModelOutput/">Model output</a></li><li><a class="tocitem" href="../../../DevDocs/DiagnosticVariableList/">Diagnostic variable list</a></li><li><a class="tocitem" href="../../../DevDocs/SystemImage/">Custom System Image</a></li></ul></li><li><a class="tocitem" href="../../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li><a class="is-disabled">Atmos</a></li><li class="is-active"><a href>Microphysics_1M</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Microphysics_1M</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Clima/ClimateMachine.jl/blob/master/docs/src/Theory/Atmos/Microphysics_1M.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Microphysics"><a class="docs-heading-anchor" href="#Microphysics">Microphysics</a><a id="Microphysics-1"></a><a class="docs-heading-anchor-permalink" href="#Microphysics" title="Permalink"></a></h1><p>We are using the <code>Microphysics_1M.jl</code> module   from the <a href="https://github.com/CliMA/CloudMicrophysics.jl">CloudMicrophysics.jl</a> package. See the <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/">documentation</a>   for further comments on the scheme derivation.</p><h2 id="Coupling-to-the-state-variables"><a class="docs-heading-anchor" href="#Coupling-to-the-state-variables">Coupling to the state variables</a><a id="Coupling-to-the-state-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Coupling-to-the-state-variables" title="Permalink"></a></h2><h3 id="Warm-Rain"><a class="docs-heading-anchor" href="#Warm-Rain">Warm Rain</a><a id="Warm-Rain-1"></a><a class="docs-heading-anchor-permalink" href="#Warm-Rain" title="Permalink"></a></h3><p>The source of rain <span>$\mathcal{S}_{q_{rai}}$</span> is a sum of the   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Rain-autoconversion">autoconversion</a>,   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Accretion">accretion</a>, and   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Rain-evaporation-and-snow-sublimation">rain evaporation</a>   processes. The sink of total water is equal to the source of rain:   <span>$\mathcal{S}_{q_{tot}}$</span> = -<span>$\mathcal{S}_{q_{rai}}$</span>. The sink of cloud liquid water is the sum of rain autoconversion   and rain accretion processes. Following the conservation equations for <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Mass">mass</a>, <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Moisture">moisture</a>, and <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Precipitating-Species">precipitation</a> the <span>$\mathcal{S}_{q_{tot}}$</span> sink has to be multiplied by <span>$\rho$</span> before   adding it as one of the sink terms to both <span>$\rho$</span> and <span>$\rho q_{tot}$</span>   state variables. The <span>$\mathcal{S}_{q_{liq}}$</span>, <span>$\mathcal{S}_{q_{rai}}$</span> sources have to be multiplied by <span>$\rho$</span>   before adding them as one of the source terms to <span>$\rho q_{liq}$</span> and   <span>$\rho q_{rai}$</span>state variables. For the conservation equation for <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Energy">total energy</a>,   the sink due to removing <span>$q_{tot}$</span> is computed as:</p><p class="math-container">\[\begin{equation}
\left. \mathcal{S}_{\rho e} \right|_{precip} =
  \left. \sum_{j\in\{v,l,i\}}(I_j + \Phi)  \rho C(q_j \rightarrow q_p) \right|_{precip} =
  (I_l + \Phi) \rho \, \mathcal{S}_{q_{tot}}
\end{equation}\]</p><p>where:</p><ul><li><span>$I_l = c_{vl} (T - T_0)$</span> is the internal energy of liquid water,</li><li><span>$T$</span> is the temperature,</li><li><span>$T_0$</span> is the thermodynamic reference temperature (which is unrelated to the reference temperature used in hydrostatic reference states used in the momentum equations),</li><li><span>$c_{vl}$</span> is the isochoric specific heat of liquid water,</li><li><span>$\Phi$</span> is the effective gravitational potential.</li></ul><h3 id="Rain-and-Snow"><a class="docs-heading-anchor" href="#Rain-and-Snow">Rain and Snow</a><a id="Rain-and-Snow-1"></a><a class="docs-heading-anchor-permalink" href="#Rain-and-Snow" title="Permalink"></a></h3><p>The source of rain <span>$\mathcal{S}_{q_{rai}}$</span> is a sum of the   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Rain-autoconversion">autoconversion</a>,   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Accretion">accretion</a>,   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Rain-evaporation-and-snow-sublimation">rain evaporation</a>, and   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Snow-melt">snow melt</a>   processes. Similarily, the source of snow <span>$\mathcal{S}_{q_{sno}}$</span> is a sum of the   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Snow-autoconversion">autoconversion</a>,   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Accretion">accretion</a>,   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Rain-evaporation-and-snow-sublimation">snow deposition/sublimation</a>, and   <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics_1M/#Snow-melt">snow melt</a>   processes. The sink of total water is equal to the sum of the rain and snow sources:   <span>$\mathcal{S}_{q_{tot}}$</span> = -<span>$\mathcal{S}_{q_{rai}}$</span> - <span>$\mathcal{S}_{q_{sno}}$</span>. The sink of cloud liquid water <span>$\mathcal{S}_{q_{liq}}$</span> is the sum of   rain autoconversion,   rain accretion with cloud liquid water, and   snow accretion with cloud liquid water processes. The sink of cloud ice <span>$\mathcal{S}_{q_{ice}}$</span> is the sum of   snow autoconversion,   snow accretion with cloud ice, and   rain accretion with cloud ice processes. Following the conservation equations for <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Mass">mass</a>, <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Moisture">moisture</a>, and <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Precipitating-Species">precipitation</a> the <span>$\mathcal{S}_{q_{tot}}$</span> sink has to be multiplied by <span>$\rho$</span> before   adding it as one of the sink terms to both <span>$\rho$</span> and <span>$\rho q_{tot}$</span>   state variables. The <span>$\mathcal{S}_{q_{liq}}$</span>, <span>$\mathcal{S}_{q_{ice}}$</span>,   <span>$\mathcal{S}_{q_{rai}}$</span>, and <span>$\mathcal{S}_{q_{sno}}$</span> sources   have to be multiplied by <span>$\rho$</span> before adding them as one of the   source terms to <span>$\rho q_{liq}$</span>, <span>$\rho q_{ice}$</span>, <span>$\rho q_{rai}$</span>, and   <span>$\rho q_{sno}$</span>state variables. For the conservation equation for <a href="https://clima.github.io/ClimateMachine.jl/latest/Theory/Atmos/AtmosModel/#Energy">total energy</a>   the source term due to microphysics processes is caused by   either removing cloud condensate outside of the working fluid   or by changing phase and releasing latent heat outside of the working fluid. Below, contributions from different microphysics processes are listed:\
The contribution from   cloud liquid water to rain autoconversion,   cloud liquid water accretion by rain,   and rain evaporation   is computed as:</p><p class="math-container">\[\begin{equation}
\left. \mathcal{S}_{\rho e} \right|_{precip} =
  - (I_l + \Phi) \rho \, \mathcal{S}_{q_{rai}}
\end{equation}\]</p><p>where:</p><ul><li><span>$I_l = c_{vl} (T - T_0)$</span> is the internal energy of liquid water,</li><li><span>$T$</span> is the temperature,</li><li><span>$T_0$</span> is the thermodynamic reference temperature (which is unrelated to the reference temperature used in hydrostatic reference states used in the momentum equations),</li><li><span>$c_{vl}$</span> is the isochoric specific heat of liquid water,</li><li><span>$\Phi$</span> is the effective gravitational potential.</li><li><span>$\mathcal{S}_{q_{rai}}$</span> is the source of rain from the above three processes.</li></ul><p>The contribution from   cloud ice to snow autoconversion,   cloud ice accretion by snow,   cloud liquid accretion by snow in temperatures below freezing,   and snow deposition/sublimation   is computed as:</p><p class="math-container">\[\begin{equation}
\left. \mathcal{S}_{\rho e} \right|_{precip} =
  - (I_i + \Phi) \rho \, \mathcal{S}_{q_{sno}}
\end{equation}\]</p><p>where:</p><ul><li><span>$I_i = c_{vi} (T - T_0) - I_{i0}$</span> is the internal energy of ice,</li><li><span>$c_{vi}$</span> is the isochoric specific heat of ice,</li><li><span>$I_{i0}$</span> is the difference in specific internal energy between ice and liquid at <span>$T_0$</span>,</li><li><span>$\mathcal{S}_{q_{sno}}$</span> is the source of snow from the above four processes.</li></ul><p>The contribution from   accretion of cloud liquid water by snow in temperatures above freezing   is computed as:</p><p class="math-container">\[\begin{equation}
\left. \mathcal{S}_{\rho e} \right|_{precip} =
  ((1 + \alpha) I_l - \alpha I_i + \Phi) \rho \, \mathcal{S}_{q_{liq}}
\end{equation}\]</p><p>where:</p><ul><li><span>$\alpha = \frac{c_{vl}}{L_f}(T - T_{freeze})$</span></li><li><span>$\mathcal{S}_{q_{liq}}$</span> is the source of cloud liquid water from</li></ul><p>accretion of cloud liquid water by snow in temperatures above freezing. The contribution from cloud ice accretion by rain (the result is snow)   is computed as:</p><p class="math-container">\[\begin{equation}
\left. \mathcal{S}_{\rho e} \right|_{precip} =
   (I_i + \Phi) \rho \, \mathcal{S}_{q_{ice}} - \rho L_f \mathcal{S}_{q_{rai}}
\end{equation}\]</p><p>where:</p><ul><li><span>$\mathcal{S}_{q_{ice}}$</span> and <span>$\mathcal{S}_{q_{rai}}$</span></li></ul><p>are the sinks of cloud ice and rain due to accretion.. Finally, the contribution from accretion between rain and snow   as well as snow melting into rain is computed as:</p><p class="math-container">\[\begin{equation}
\left. \mathcal{S}_{\rho e} \right|_{precip} =
   \rho L_f \mathcal{S}_{q_{sno}}
\end{equation}\]</p><p>where:</p><ul><li><span>$\mathcal{S}_{q_{sno}}$</span> is the source of snow in those two processes.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Microphysics_0M/">Â« Microphysics_0M</a><a class="docs-footer-nextpage" href="../EDMFEquations/">EDMF equations Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 11 August 2021 23:53">Wednesday 11 August 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
